<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id='action_advanced_sale' model='ir.actions.act_window'>
        <field name="name">Advanced Sale</field>
        <field name="res_model">sale.order</field>
        <field name="view_mode">kanban,tree,form</field>
    </record>
    <menuitem name="My Sale" id="advanced_sale_base_menu" />
    <menuitem name="Detail" id="advanced_sales_menu" parent="advanced_sale_base_menu" action="action_advanced_sale"/>
    <!--Inherit the sale order form-->
    <record id="form_sale_order_custom" model="ir.ui.view">
        <field name="name">sale.order.custom.form.inherited</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <header>
                <xpath expr="//button[@name='discount_customer']" position="after">
                    <button string="Check" name="discount_customer" />
                </xpath>
            </header>
              <xpath expr="//field[@name='partner_id']" position="after">
                   <field name="customer_discount_code"/>
              </xpath>
              <xpath expr="//field[@name='customer_discount_code']" position="after">
                    <field name="discounttat"/>
              </xpath>
             <xpath expr="//field[@name='tax_totals_json']" position="after">
                 <field name="show_discount_total" class="o_form_label"/>
             </xpath>
        </field>
    </record>
    <!--Inherit the sale order view-->
    <record id="view_sale_order_custom" model="ir.ui.view">
        <field name="name">sale.order.custom.view.inherited</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_tree"/>
        <field name="arch" type="xml">
              <xpath expr="//field[@name='partner_id']" position="after">
                   <field name="customer_discount_code"/>
              </xpath>
              <xpath expr="//field[@name='amount_total']" position="replace">
                    <field name="Sale_order_discount_estimated" sum="Total Discount Last Included" widget="monetary" decoration-bf="1"/>
              </xpath>
              <xpath expr="//field[@name='Sale_order_discount_estimated']" position="before">
                   <field name="show_discount_total" sum="Total Discount"/>
              </xpath>
        </field>
    </record>
</odoo>